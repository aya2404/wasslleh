# ⚙️ دليل التكوين والإعدادات - تطبيق وصلة

## 📋 نظرة عامة

مجلد التكوين يحتوي على جميع ملفات الإعدادات وإدارة مفاتيح APIs والتحقق من صحة البيئة. هذا المجلد مهم جداً لضمان عمل التطبيق بشكل صحيح وآمن.

## 📁 محتويات المجلد

```
config/
├── 📖 README.md                 # دليل شامل بالإنجليزية
├── 🔧 apiConfig.ts              # تكوين شامل لجميع APIs
├── 🔐 apiKeysManager.ts         # إدارة آمنة لمفاتيح APIs
├── ✅ envValidation.ts          # التحقق من متغيرات البيئة
└── 💼 linkedinApiConfig.ts      # إعدادات خاصة بـ LinkedIn
```

---

## 🔧 apiConfig.ts - التكوين الرئيسي

### **الوظيفة الأساسية**:
هذا الملف يحتوي على جميع إعدادات APIs والخدمات الخارجية المستخدمة في التطبيق.

### **الخدمات المُكونة**:

#### 🗺️ **Google Maps**
```typescript
googleMaps: {
  apiKey: string;           // مفتاح Google Maps API
  mapId: string;           // معرف الخريطة المخصصة
  libraries: string[];     // المكتبات المطلوبة
  region: string;          // المنطقة الجغرافية
  language: string;        // لغة الواجهة
}
```

**الاستخدام**:
- عرض الخرائط التفاعلية
- حساب المسارات والاتجاهات
- البحث عن الأماكن
- تحديد المواقع

#### 💼 **LinkedIn API**
```typescript
linkedin: {
  clientId: string;        // معرف التطبيق
  clientSecret: string;    // المفتاح السري
  scope: string[];         // الصلاحيات المطلوبة
  redirectUri: string;     // رابط الإعادة بعد المصادقة
}
```

**الاستخدام**:
- البحث في الوظائف
- تسجيل الدخول بـ LinkedIn
- الوصول لبيانات الملف الشخصي
- مشاركة المحتوى

#### 🗣️ **Azure Text-to-Speech**
```typescript
azure: {
  ttsKey: string;          // مفتاح خدمة النطق
  ttsRegion: string;       // منطقة الخادم
  translatorKey: string;   // مفتاح خدمة الترجمة
  translatorRegion: string; // منطقة خدمة الترجمة
}
```

**الأصوات المدعومة**:
- `ar-JO-TaimNeural`: صوت ذكر أردني
- `ar-JO-SanaNeural`: صوت أنثى أردنية
- `ar-SA-HamedNeural`: صوت ذكر سعودي
- `ar-SA-ZariyahNeural`: صوت أنثى سعودية

#### 🌐 **Google Translate**
```typescript
googleTranslate: {
  apiKey: string;          // مفتاح خدمة الترجمة
  supportedLanguages: string[]; // اللغات المدعومة
}
```

#### 👁️ **OCR Service**
```typescript
ocr: {
  apiKey: string;          // مفتاح خدمة OCR
  apiUrl: string;          // رابط الخدمة
  supportedFormats: string[]; // صيغ الملفات المدعومة
}
```

#### 🤖 **Gemini AI**
```typescript
gemini: {
  apiKey: string;          // مفتاح Gemini AI
  model: string;           // نموذج الذكاء الاصطناعي
  maxTokens: number;       // الحد الأقصى للرموز
}
```

#### 🛒 **Amazon Product API**
```typescript
amazon: {
  accessKey: string;       // مفتاح الوصول
  secretKey: string;       // المفتاح السري
  associateTag: string;    // تاج الشراكة
  region: string;          // المنطقة
}
```

#### 🗄️ **Supabase**
```typescript
supabase: {
  url: string;             // رابط المشروع
  anonKey: string;         // المفتاح العام
  serviceRoleKey: string;  // مفتاح دور الخدمة
}
```

### **إعدادات المنطقة**:

التطبيق يدعم عدة مناطق عربية مع إعدادات مخصصة لكل منها:

#### 🇯🇴 **الأردن** (الافتراضي):
```typescript
jordan: {
  country: 'الأردن',
  currency: 'JOD',
  timezone: 'Asia/Amman',
  coordinates: { lat: 31.9522, lng: 35.9104 },
  language: 'ar-JO',
  places: [
    'مستشفى الجامعة الأردنية',
    'مول العبدلي',
    'الجامعة الأردنية',
    'مطار الملكة علياء الدولي'
  ]
}
```

#### 🇸🇦 **السعودية**:
```typescript
saudi: {
  country: 'السعودية',
  currency: 'SAR',
  timezone: 'Asia/Riyadh',
  coordinates: { lat: 24.7136, lng: 46.6753 },
  language: 'ar-SA'
}
```

#### 🇦🇪 **الإمارات**:
```typescript
uae: {
  country: 'الإمارات',
  currency: 'AED',
  timezone: 'Asia/Dubai',
  coordinates: { lat: 25.2048, lng: 55.2708 },
  language: 'ar-AE'
}
```

#### 🇪🇬 **مصر**:
```typescript
egypt: {
  country: 'مصر',
  currency: 'EGP',
  timezone: 'Africa/Cairo',
  coordinates: { lat: 30.0444, lng: 31.2357 },
  language: 'ar-EG'
}
```

### **كلاس إدارة التكوين**:

```typescript
class APIConfigManager {
  // حفظ الإعدادات
  static saveConfig(config: Partial<APIConfig>): boolean
  
  // تحميل الإعدادات
  static loadConfig(): APIConfig
  
  // إعادة تعيين الإعدادات
  static resetConfig(): boolean
  
  // التحقق من صحة مفاتيح Google Maps
  static hasValidGoogleMapsKey(): boolean
  
  // التحقق من صحة مفاتيح Azure
  static hasValidAzureKeys(): boolean
  
  // الحصول على إعدادات المنطقة
  static getRegionConfig(): RegionConfig
  
  // الحصول على إعدادات الصوت
  static getVoiceConfig(): VoiceConfig
}
```

**أمثلة الاستخدام**:
```typescript
// تحميل الإعدادات
const config = APIConfigManager.loadConfig();

// التحقق من وجود مفتاح Google Maps
if (APIConfigManager.hasValidGoogleMapsKey()) {
  // استخدام خدمة الخرائط
  initializeGoogleMaps();
}

// الحصول على إعدادات المنطقة
const regionConfig = APIConfigManager.getRegionConfig();
console.log(`المنطقة: ${regionConfig.country}`);
```

---

## 🔐 apiKeysManager.ts - إدارة المفاتيح الآمنة

### **الوظيفة الأساسية**:
إدارة آمنة لحفظ واسترداد والتحقق من صحة مفاتيح APIs.

### **ميزات الأمان**:

#### 🔒 **التشفير**:
```typescript
class SimpleEncryption {
  static encrypt(text: string): string    // تشفير النص
  static decrypt(encryptedText: string): string // فك التشفير
}
```

#### 🔍 **التحقق من الصحة**:
```typescript
interface ApiKeyValidation {
  isValid: boolean;        // هل المفتاح صالح؟
  error?: string;          // رسالة خطأ إن وجدت
  lastChecked?: Date;      // آخر مرة تم فحصها
  rateLimitRemaining?: number; // الطلبات المتبقية
}
```

### **الوظائف الرئيسية**:

#### `setApiKey(service, key, subKey?)`
```typescript
/**
 * حفظ مفتاح API بشكل آمن
 * @param service - اسم الخدمة
 * @param key - المفتاح
 * @param subKey - مفتاح فرعي (اختياري)
 */
static setApiKey(
  service: keyof APIConfig, 
  key: string, 
  subKey?: string
): boolean
```

#### `getApiKey(service, subKey?)`
```typescript
/**
 * استرداد مفتاح API
 * @param service - اسم الخدمة
 * @param subKey - مفتاح فرعي (اختياري)
 * @returns المفتاح أو فارغ
 */
static getApiKey(
  service: keyof APIConfig, 
  subKey?: string
): string
```

#### `validateApiKey(service, subKey?)`
```typescript
/**
 * التحقق من صحة مفتاح API
 * @param service - اسم الخدمة
 * @param subKey - مفتاح فرعي (اختياري)
 * @returns نتيجة التحقق
 */
static async validateApiKey(
  service: keyof APIConfig, 
  subKey?: string
): Promise<ApiKeyValidation>
```

### **وظائف إضافية**:

#### إدارة النسخ الاحتياطي:
```typescript
// تصدير المفاتيح
static exportKeys(): string

// استيراد المفاتيح
static importKeys(keysJson: string): boolean

// مسح جميع المفاتيح
static clearAllKeys(): boolean
```

#### الحصول على الإحصائيات:
```typescript
// حالة جميع المفاتيح
static getApiKeysStatus(): Record<string, {
  configured: boolean;
  valid?: boolean;
}>
```

**مثال الاستخدام**:
```typescript
// حفظ مفتاح Google Maps
SecureAPIKeysManager.setApiKey('googleMaps', 'AIzaSyC...', 'apiKey');

// التحقق من صحة المفتاح
const validation = await SecureAPIKeysManager.validateApiKey('googleMaps', 'apiKey');
if (!validation.isValid) {
  console.error('مفتاح Google Maps غير صالح:', validation.error);
}

// الحصول على إحصائيات عامة
const status = SecureAPIKeysManager.getApiKeysStatus();
console.log('حالة المفاتيح:', status);
```

---

## ✅ envValidation.ts - التحقق من البيئة

### **الوظيفة الأساسية**:
التحقق من صحة واكتمال جميع متغيرات البيئة المطلوبة.

### **قائمة المتغيرات المطلوبة**:

#### 🔑 **APIs الأساسية**:
```typescript
const REQUIRED_ENV_VARS: RequiredEnvVar[] = [
  {
    key: 'VITE_GOOGLE_MAPS_API_KEY',
    description: 'مفتاح Google Maps API للخرائط والمسارات',
    required: true,
    pattern: /^AIza[0-9A-Za-z-_]{35}$/,
    example: 'AIzaSyC...'
  },
  {
    key: 'VITE_AZURE_TTS_API_KEY',
    description: 'مفتاح Azure TTS للنطق باللهجة الأردنية',
    required: true,
    minLength: 32
  }
  // ... المزيد من المتغيرات
]
```

### **أنواع التحقق**:

#### 📏 **طول النص**:
```typescript
minLength?: number;        // الحد الأدنى لطول المفتاح
```

#### 🔍 **النمط (Pattern)**:
```typescript
pattern?: RegExp;          // تعبير منتظم للتحقق من التنسيق
```

#### 📝 **مثال**:
```typescript
example?: string;          // مثال توضيحي
```

### **كلاس التحقق**:

```typescript
class EnvironmentValidator {
  // التحقق من جميع المتغيرات
  static validateEnvironment(): EnvValidationResult
  
  // التحقق من مجموعة معينة
  static validateServiceKeys(serviceKeys: string[]): EnvValidationResult
  
  // إنشاء تقرير مفصل
  static generateReport(): string
  
  // فحص سريع للحد الأدنى
  static quickCheck(): boolean
  
  // الحصول على معلومات متغير
  static getVarInfo(key: string): RequiredEnvVar | undefined
  
  // تجميع المتغيرات حسب الخدمة
  static getVarsByService(): Record<string, RequiredEnvVar[]>
}
```

### **نتيجة التحقق**:

```typescript
interface EnvValidationResult {
  isValid: boolean;         // هل جميع المتغيرات صالحة؟
  errors: string[];         // قائمة بالأخطاء
  warnings: string[];       // قائمة بالتحذيرات
  missingKeys: string[];    // المتغيرات المفقودة
  validKeys: string[];      // المتغيرات الصالحة
}
```

**مثال الاستخدام**:
```typescript
// فحص شامل
const validation = EnvironmentValidator.validateEnvironment();

if (!validation.isValid) {
  console.error('مشاكل في البيئة:');
  validation.errors.forEach(error => console.error('- ' + error));
}

// إنشاء تقرير
const report = EnvironmentValidator.generateReport();
console.log(report);

// فحص سريع
const isReady = EnvironmentValidator.quickCheck();
if (isReady) {
  console.log('✅ التطبيق جاهز للتشغيل');
} else {
  console.log('❌ يوجد مشاكل في التكوين');
}
```

---

## 💼 linkedinApiConfig.ts - إعدادات LinkedIn

### **الوظيفة الأساسية**:
إعدادات تفصيلية خاصة بـ LinkedIn API لإدارة الوظائف والشبكات المهنية.

### **نقاط النهاية (Endpoints)**:

```typescript
const LINKEDIN_ENDPOINTS = {
  // OAuth
  authorization: 'https://www.linkedin.com/oauth/v2/authorization',
  accessToken: 'https://www.linkedin.com/oauth/v2/accessToken',
  
  // الملف الشخصي
  profile: 'https://api.linkedin.com/v2/people/~',
  
  // البحث في الوظائف
  jobSearch: 'https://api.linkedin.com/v2/jobSearchResults',
  
  // تفاصيل الوظيفة
  jobDetails: 'https://api.linkedin.com/v2/jobs/{jobId}',
  
  // الشركات
  companies: 'https://api.linkedin.com/v2/organizations',
}
```

### **الصلاحيات المطلوبة**:

```typescript
const LINKEDIN_SCOPES = [
  'r_liteprofile',         // قراءة الملف الشخصي الأساسي
  'r_emailaddress',        // قراءة البريد الإلكتروني
  'w_member_social',       // مشاركة المحتوى
]
```

### **تكوين البحث**:

```typescript
interface JobSearchConfig {
  keywords?: string;        // كلمات البحث
  locationName?: string;    // اسم الموقع
  start?: number;          // نقطة البداية للنتائج
  count?: number;          // عدد النتائج
  sortBy?: 'RELEVANCE' | 'DATE'; // ترتيب النتائج
  filters?: {
    experience?: string[];  // مستوى الخبرة
    jobType?: string[];    // نوع الوظيفة
    company?: string[];    // الشركة
  };
}
```

---

## 🛠️ إعداد البيئة خطوة بخطوة

### **الخطوة 1: نسخ ملف البيئة**
```bash
cp .env.example .env
```

### **الخطوة 2: تحرير الملف**
```bash
# افتح محرر النصوص
nano .env

# أو استخدم VS Code
code .env
```

### **الخطوة 3: إضافة المفاتيح**
```env
# خرائط Google
VITE_GOOGLE_MAPS_API_KEY=AIzaSyC1234567890abcdef...

# LinkedIn API
VITE_LINKEDIN_CLIENT_ID=86x1xl123...
VITE_LINKEDIN_CLIENT_SECRET=secret123...

# Azure TTS
VITE_AZURE_TTS_API_KEY=a1b2c3d4...
VITE_AZURE_TTS_REGION=eastus

# Supabase
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6...
```

### **الخطوة 4: التحقق من الإعداد**
```typescript
// في التطبيق
import { EnvironmentValidator } from './config/envValidation';

const validation = EnvironmentValidator.validateEnvironment();
console.log('حالة البيئة:', validation);
```

---

## 🔍 استكشاف الأخطاء الشائعة

### **❌ مفتاح API غير صالح**
```typescript
// الحل
const validation = await SecureAPIKeysManager.validateApiKey('googleMaps', 'apiKey');
if (!validation.isValid) {
  console.error('المشكلة:', validation.error);
  // تحقق من صحة المفتاح في وحدة التحكم الخاصة بالخدمة
}
```

### **❌ متغير البيئة مفقود**
```typescript
// الحل
const report = EnvironmentValidator.generateReport();
console.log(report); // سيُظهر المتغيرات المفقودة
```

### **❌ مشكلة في الشبكة**
```typescript
// الحل
// تحقق من اتصال الإنترنت
// تحقق من حدود الاستخدام لكل API
// راجع سجلات الأخطاء في وحدة التحكم
```

---

## 📈 مراقبة الأداء

### **إحصائيات الاستخدام**:
```typescript
// تتبع استخدام APIs
const usage = SecureAPIKeysManager.getApiKeysStatus();
console.log('معدل الاستخدام:', usage);
```

### **مراقبة الأخطاء**:
```typescript
// تسجيل الأخطاء
window.addEventListener('error', (event) => {
  console.error('خطأ في التطبيق:', event.error);
});
```

---

## 🔒 أفضل ممارسات الأمان

### **✅ ما يجب فعله**:
- استخدم متغيرات البيئة دائماً
- اتبع مبدأ أقل الصلاحيات
- راقب استخدام APIs بانتظام
- احتفظ بنسخ احتياطية آمنة

### **❌ ما يجب تجنبه**:
- لا تضع المفاتيح في الكود مباشرة
- لا ترفع ملف .env إلى Git
- لا تشارك المفاتيح عبر الرسائل
- لا تستخدم مفاتيح بدون قيود

---

## 📚 موارد إضافية

- [دليل إعداد APIs المفصل](../docs/API_KEYS_GUIDE.md)
- [دليل الأمان والحماية](../docs/SECURITY_GUIDE.md)
- [أمثلة التكوين](../docs/CONFIG_EXAMPLES.md)
- [استكشاف الأخطاء](../docs/TROUBLESHOOTING.md)

---

**🎯 الهدف**: تكوين آمن وموثوق لجميع خدمات التطبيق!